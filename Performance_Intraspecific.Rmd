---
title: "Intraspecific Fitness affect"
author: "Richard Honor"
date: "05/05/2020"
output: html_document
---

#Read in and prep data
```{r}
library(ggplot2)
library(dplyr)
library(car)
library("glmmTMB")


#read in data
rm(list=ls())
dat<-read.csv("DataSynthesis.csv",stringsAsFactors = F)


#remove those with fertilizer treatment, and extra genotypes that are only in the alone treatment. 
dat<-dat[!grepl("i",dat$Sample,fixed=T),]


#Function to standardize data.
Standardize<-function(x,set.sd=F,SD){
  if(set.sd==T){
      standard<-(x-mean(x,na.rm=T))/SD
  }
  else{
     standard<-(x-mean(x,na.rm=T))/sd(x,na.rm=T)
  }
}


dat$Fern<-log(dat$Fern+1)
dat$gluc_Conc<-log(dat$gluc_Conc)
dat$flav_Conc<-log(dat$flav_Conc)
dat$ChlorA<-log(dat$ChlorA)
dat$ThripsDam<-log(dat$ThripsDam+1)
dat$BlackPathDam<-log(dat$BlackPathDam+1)



#Calculating leaf area 
dat$GM_Leaf_Area<-dat$GM_Leaf_Wid*dat$GM_Leaf_Len

#Average Duplicates. 
dat2<-dat %>% select(-X) %>% group_by(Tag) %>%  summarize(gh_col=first(gh_col),gh_bench=first(gh_bench),treatment=first(treatment),GA3=first(GA3),Family=first(Family),Maple_StemHeight_End=mean(Maple_StemHeight_End),Maple_LeafNum_End=mean(Maple_LeafNum_End),maple_leaf_length_0=mean(maple_leaf_length_0),maple_leaves_0=mean(maple_leaves_0),Maple_TotalLeafArea_End=mean(Maple_TotalLeafArea_End),MapleDamage=mean(Maple_Damage_End),Fern=first(Fern),gluc_Conc=mean(gluc_Conc),flav_Conc=mean(flav_Conc),maple_height_0=mean(maple_height_0),ChlorA=mean(ChlorA), GM_TotalLeaf_Area=first(GM_TotalLeaf_Area),ThripsDam=mean(ThripsDam),BlackPathDam=mean(BlackPathDam),WhiteFungDam=mean(WhiteFungDam),comp_number=first(comp_number),GM_Leaf_Area=mean(GM_Leaf_Area),
                                                          GM_StemHeight_Bolt=first(GM_StemHeight_Bolt),
GM_Leaf_Number_Bolt=first(GM_Leaf_Number_Bolt),
Larg_Leaf_Len_Bolt=first(Larg_Leaf_Len_Bolt),
Larg_Leaf_Wid_Bolt=first(Larg_Leaf_Wid_Bolt),
Row_Field=first(Row_Field),
Col_Field=first(Col_Field),
Maple_Died=first(Maple_Died),
Maple_TotalLeafArea_End=first(Maple_TotalLeafArea_End),
GM_Fecundity=first(GM_Fecundity),
MapleFinalMass=first(MapleFinalMass))


#Creating Survival Data.1 = survived, 0= dead.
dat2$Bolt_Survival[dat2$GM_StemHeight_Bolt=="Dead"]<-0
dat2$Bolt_Survival[dat2$GM_StemHeight_Bolt!="Dead"]<-1


#Creating Maple Survival Data.1 = survived, 0= dead.
dat2$Maple_Died<-as.character(dat2$Maple_Died)
dat2$Maple_Survival[dat2$Maple_Died!="Y"]<-1
dat2$Maple_Survival[dat2$Maple_Died=="Y"]<-0
dat2<-dat2 %>% select(-Maple_Died)

dat2[which(dat2$GM_Leaf_Number_Bolt=="Dead"&!is.na(dat2$GM_Fecundity)),]$Bolt_Survival<-1


#Converting white fungal damage to logistic. 
dat2$WhiteFungLogis<-NA
dat2$WhiteFungLogis[dat2$WhiteFungDam>0]<-"Yes"
dat2$WhiteFungLogis[dat2$WhiteFungDam==0]<-"No"


dat2<-dat2[!grepl("maple",dat2$Tag,fixed = T),]

dat2<-dat2[dat2$treatment=="gm",]


#All of these genotypes died (15 Genotypes).(We are simply missing a final measurement for e|JBCHY1-1-50|Q|240) That is only 3% Mortality. 
dead<-dat2[is.na(dat2$GM_TotalLeaf_Area),]

#Removing those with dead competitors from the garlic mustard treatment. ("e|JBCHY1-1-50|Q|240") did not die, we are simply missing the final measurement for it.

dead_competitors<-dead %>% filter(treatment=="gm",Tag!="e|JBCHY1-1-50|Q|240") %>% select(comp_number)

#Removing those with dead competitors from the analysis. 
dat2<-dat2 %>% filter(!comp_number %in% dead_competitors$comp_number)
dat<-dat %>% filter(!comp_number %in% dead_competitors$comp_number)
dat2<-dat2[dat2$comp_number!=79,]
dat2<-dat2[dat2$comp_number!=37,]
dat2<-dat2[dat2$comp_number!=59,]
```


#PCA of GM SIZE in the second year. 
```{r}
#Removing dead individuals with zeros. 
dat2$GM_StemHeight_Bolt[which(dat2$GM_StemHeight_Bolt=="Dead")]<-0
dat2$GM_Leaf_Number_Bolt[which(dat2$GM_Leaf_Number_Bolt=="Dead")]<-0
dat2$Larg_Leaf_Len_Bolt[which(dat2$Larg_Leaf_Len_Bolt=="Dead")]<-0
dat2$Larg_Leaf_Wid_Bolt[which(dat2$Larg_Leaf_Wid_Bolt=="Dead")]<-0

#Making data numeric
dat2$GM_StemHeight_Bolt<-as.numeric(dat2$GM_StemHeight_Bolt)
dat2$GM_Leaf_Number_Bolt<-as.numeric(dat2$GM_Leaf_Number_Bolt)
dat2$Larg_Leaf_Len_Bolt<-as.numeric(dat2$Larg_Leaf_Len_Bolt)
dat2$Larg_Leaf_Wid_Bolt<-as.numeric(dat2$Larg_Leaf_Wid_Bolt)


pca<-prcomp(~GM_StemHeight_Bolt+GM_Leaf_Number_Bolt+Larg_Leaf_Len_Bolt+Larg_Leaf_Wid_Bolt,data=dat2,scale.=T,na.action=na.omit)

prediction<-as.data.frame(predict(pca))

df<-tibble::rownames_to_column(prediction, "rownumber")

dat2[df$rownumber,"PC1BoltSize"]<-df$PC1

hist(dat2$PC1BoltSize) #The data is very zero inflated because of the mortality. This isnt great but what can you do. 
```


```{r}
table(dat2$comp_number)
#Generating collumn for the competitor family.
count=0
dat2$Family<-as.character(dat2$Family)
for(i in 1:length(dat2$comp_number)){
  temp<-dat2[dat2$comp_number==dat2$comp_number[i]&dat2$Tag!=dat2$Tag[i],c("Family","GM_TotalLeaf_Area","gluc_Conc","PC1BoltSize","Bolt_Survival")]#Selects the competitors data
count=count+1

  if(length(temp$Family[!is.na(temp$Family)])==0){ #if there are no values...Makes the values NA
   dat2$competitor[i]<-NA
  }
else{ #Assign the competitor data to the data frame. 
    dat2$competitor[i]<-temp$Family[!is.na(temp$Family)] 
}

  if(length(temp$GM_TotalLeaf_Area[!is.na(temp$GM_TotalLeaf_Area)])==0){
   dat2$comp_Size[i]<-NA
  }
else{
   dat2$comp_Size[i]<-temp$GM_TotalLeaf_Area[!is.na(temp$GM_TotalLeaf_Area)]  
}

  if(length(temp$gluc_Conc[!is.na(temp$gluc_Conc)])==0){
   dat2$comp_Gluc[i]<-NA
 }
  else {
  dat2$comp_Gluc[i]<-temp$gluc_Conc[!is.na(temp$gluc_Conc)]
  }

  if(length(temp$PC1BoltSize[!is.na(temp$PC1BoltSize)])==0){
   dat2$CompSizeBolt[i]<-NA
 }
  else {
  dat2$CompSizeBolt[i]<-temp$PC1BoltSize[!is.na(temp$PC1BoltSize)]
  }

  if(length(temp$Bolt_Survival[!is.na(temp$Bolt_Survival)])==0){
   dat2$Comp_Survival[i]<-NA
 }
  else {
  dat2$Comp_Survival[i]<-temp$Bolt_Survival[!is.na(temp$Bolt_Survival)]
    }
}
dat2
dat2$GM_Leaf_Number_Bolt
```




#What predicts performance in the intraspecific treatment? - no weighed pathogen data
```{r}
#Modelling random effects 

fit<-glmmTMB(GM_TotalLeaf_Area~Fern+BlackPathDam+WhiteFungLogis+(1|Family)+(1|gh_bench),data=dat2)

fit2<-glmmTMB(GM_TotalLeaf_Area~Fern+BlackPathDam+WhiteFungLogis+(1|gh_bench),data=dat2)

fit3<-glmmTMB(GM_TotalLeaf_Area~Fern+BlackPathDam+WhiteFungLogis+(1|Family),data=dat2)

#Is bench important?
anova(fit,fit3) #no it is not.

#Is family important? 
anova(fit,fit2) #Yes it is. 


#Modelling fixed effects 

fit<-glmmTMB(GM_TotalLeaf_Area~Fern+ThripsDam+BlackPathDam+WhiteFungLogis+competitor+comp_Size+(1|Family),data=dat2)

fit2<-update(fit,~.-competitor)
anova(fit,fit2) #competitor not significant predictor. 
summary(fit2)

fit3<-update(fit2,~.-WhiteFungLogis)
anova(fit3,fit2) #White fungal damage not singificant.
summary(fit3)

fit4<-update(fit3,~.-Fern)
anova(fit4,fit3) #Fern not significant
summary(fit4)

#All else is significant. IS gluc_Conc also significant? 

fit5<-glmmTMB(GM_TotalLeaf_Area~ThripsDam+BlackPathDam+comp_Size+comp_Gluc+(1|Family),data=dat2)
summary(fit5) #Glucosinolate is not significant. Therefore, size is significant. is family significant if the effect of size is removed? 


fit5<-glmmTMB(GM_TotalLeaf_Area~ThripsDam+BlackPathDam+competitor+(1|Family),data=dat2)
fit6<-glmmTMB(GM_TotalLeaf_Area~ThripsDam+BlackPathDam+(1|Family),data=dat2)
anova(fit5,fit6) #Even without size included, id of neighbor is not singificant. This is likley because of a lack of sample sie available only in this treament. 


#Best model
fit<-glmmTMB(GM_TotalLeaf_Area~Standardize(comp_Size)+Standardize(ThripsDam)+Standardize(BlackPathDam)+(1|Family),data=dat2[!is.na(dat2$comp_Size),])

fit2<-glmmTMB(GM_TotalLeaf_Area~+Standardize(ThripsDam)+Standardize(BlackPathDam)+(1|Family),data=dat2[!is.na(dat2$comp_Size),])
anova(fit,fit2)
summary(fit)

plot(residuals(fit))
qqnorm(residuals(fit))
plot(residuals(fit,type="pearson"))
plot(residuals(fit,type="pearson")~fitted(fit))


#Coefficients for results
fit<-glmmTMB(Standardize(GM_TotalLeaf_Area,set.sd=T,3549.252)~Standardize(comp_Size)+Standardize(ThripsDam)+Standardize(BlackPathDam)+(1|Family),data=dat2[!is.na(dat2$comp_Size),])
summary(fit)

#-0.31502 effect on SD per SD unit. (GM on GM)

GMonGM<-Standardize(dat2$comp_Size)
GMonGM
#write.csv(GMonGM,"GM_SD_OnGM.csv")
```



#Is there evidence that there is a cost of glucosinolates or flavonoid production in this treatment? 
```{r}
#I must control for leaf size, because there are less glucosinolates with larger leaf sizes. 
fit7<-lmer(GM_TotalLeaf_Area~ BlackPathDam+ WhiteFungLogis+gluc_Conc+GM_Leaf_Area+(1|Family),data=dat2)
summary(fit7) #Not for glucosinolates... significantly positive correlation.

fit7<-lmer(GM_TotalLeaf_Area~BlackPathDam + WhiteFungLogis+flav_Conc+GM_Leaf_Area+(1|Family),data=dat2)
summary(fit7) #Not for flavonoids (Significant postive correlation. )

```



#Calculating genetic correlation between gluc, chlor and total size. 
```{r}

#Standardizing variables
dat2$gluc_ConcS<-Standardize(dat2$gluc_Conc)
dat2$ChlorAS<-Standardize(dat2$ChlorA)
dat2$GM_TotalLeaf_AreaS<-Standardize(dat2$GM_TotalLeaf_Area)

dat2$Family<-as.character(dat2$Family)



datG<-dat2 %>% select(Tag,Family,gluc_ConcS,ChlorAS,GM_TotalLeaf_AreaS,gh_bench) %>%  pivot_longer(c(gluc_ConcS,ChlorAS,GM_TotalLeaf_AreaS))

datG<-dat2 %>% select(Tag,Family,gluc_ConcS,ChlorAS,GM_TotalLeaf_AreaS,gh_bench) %>%  pivot_longer(c(gluc_ConcS,ChlorAS,GM_TotalLeaf_AreaS))


glmmTMB(value ~ -1+name*gh_bench+(-1+name|Family),REML=T,data=datG)
#did not converge... removing bench interaction.

glmmTMB(value ~ -1+name+gh_bench+(-1+name|Family),REML=T,data=datG)
#Did not converge, removing bench. 
glmmTMB(value ~ -1+(-1+name|Family),REML=T,data=datG)
#Still did not converge. 

```


#GM survival
```{r}
dat2$Comp_Survival<-as.factor(dat2$Comp_Survival)
fit<-glmmTMB(Bolt_Survival~Fern+BlackPathDam+WhiteFungLogis+competitor+Standardize(comp_Size)+Comp_Survival+Standardize(GM_TotalLeaf_Area)+(1|Family),data=dat2[!is.na(dat2$BlackPathDam),],family="binomial")

fit1<-glmmTMB(Bolt_Survival~Fern+WhiteFungLogis+competitor+comp_Size+Comp_Survival+Standardize(GM_TotalLeaf_Area)+(1|Family),data=dat2[!is.na(dat2$BlackPathDam),],family="binomial")
anova(fit,fit1) #Model wouldnt fit... dont know 

fit1<-glmmTMB(Bolt_Survival~Fern+WhiteFungLogis+competitor+Standardize(GM_TotalLeaf_Area)+comp_Size+Comp_Survival+(1|Family),data=dat2[!is.na(dat2$WhiteFungLogis),],family="binomial")
fit2<-glmmTMB(Bolt_Survival~Fern+competitor+Standardize(GM_TotalLeaf_Area)+comp_Size+Comp_Survival+(1|Family),data=dat2[!is.na(dat2$WhiteFungLogis),],family="binomial")
anova(fit2,fit1) #Model wouldnt fit... dont know 

#IS Fern important?
fit2<-glmmTMB(Bolt_Survival~Fern+competitor+Standardize(GM_TotalLeaf_Area)+comp_Size+Comp_Survival+(1|Family),data=dat2[!is.na(dat2$Fern),],family="binomial")
fit3<-glmmTMB(Bolt_Survival~competitor+Standardize(GM_TotalLeaf_Area)+comp_Size+Comp_Survival+(1|Family),data=dat2[!is.na(dat2$Fern),],family="binomial")

anova(fit2,fit3) #Model wouldnt fit, dont know

#Is SIze important?
fit3<-glmmTMB(Bolt_Survival~competitor+Standardize(GM_TotalLeaf_Area)+Standardize(comp_Size)+Comp_Survival+(1|Family),data=dat2[!is.na(dat2$GM_TotalLeaf_Area),],family="binomial")
fit4<-glmmTMB(Bolt_Survival~competitor+comp_Size+Comp_Survival+(1|Family),data=dat2[!is.na(dat2$GM_TotalLeaf_Area),],family="binomial")
anova(fit3,fit4) #Model wouldnt fit, dont know

#Is competitor important? 
fit4<-glmmTMB(Bolt_Survival~competitor+comp_Size+Comp_Survival+(1|Family),data=dat2[!is.na(dat2$competitor),],family="binomial")
fit5<-glmmTMB(Bolt_Survival~comp_Size+Comp_Survival+(1|Family),data=dat2[!is.na(dat2$competitor),],family="binomial")
anova(fit4,fit5) #Model wouldnt fit dont know.

#Is competitor size important? 
fit4<-glmmTMB(Bolt_Survival~competitor+comp_Size+Comp_Survival+(1|Family),data=dat2[!is.na(dat2$comp_Size),],family="binomial")
fit5<-glmmTMB(Bolt_Survival~competitor+Comp_Survival+(1|Family),data=dat2[!is.na(dat2$comp_Size),],family="binomial")
anova(fit4,fit5) #CModel wouldnt fit dont know 

#IS comp survival important? 
fit5<-glmmTMB(Bolt_Survival~competitor+Comp_Survival+(1|Family),data=dat2[!is.na(dat2$Comp_Survival),],family="binomial")
fit6<-glmmTMB(Bolt_Survival~competitor+(1|Family),data=dat2[!is.na(dat2$Comp_Survival),],family="binomial")
anova(fit5,fit6) #Yes, competitor survival is incredibly important to determien the survival of the focal plant. 

fit5<-glmmTMB(Bolt_Survival~Comp_Survival+(1|Family),data=dat2[!is.na(dat2$Comp_Survival),],family="binomial")
summary(fit5)

table(dat2$Bolt_Survival,dat2$Comp_Survival)
102/(102+11)*100
11/(102+11)*100
11/(42+11)*100
42/(42+11)*100


#Is competitor important? 
fit5<-glmmTMB(Bolt_Survival~competitor+Comp_Survival+(1|Family),family="binomial",data=dat2)
fit6<-glmmTMB(Bolt_Survival~Comp_Survival+(1|Family),family="binomial",data=dat2)
anova(fit5,fit6) #No competitor is not important, but it is on the edge of significance. (0.053)

#Is competitor size important? 

fit6<-glmmTMB(Bolt_Survival~Comp_Survival+Standardize(comp_Size)+(1|Family),family="binomial",data=dat2[!is.na(dat2$comp_Size),])

fit7<-glmmTMB(Bolt_Survival~Comp_Survival+(1|Family),family="binomial",data=dat2[!is.na(dat2$comp_Size),])
anova(fit6,fit7) #No competitor size is not important. 
summary(fit6)


#Is size important? 
fit6<-glmmTMB(Bolt_Survival~Comp_Survival+Standardize(GM_TotalLeaf_Area)+(1|Family),family="binomial",data=dat2[!is.na(dat2$GM_TotalLeaf_Area),])

fit7<-glmmTMB(Bolt_Survival~Comp_Survival+(1|Family),family="binomial",data=dat2[!is.na(dat2$GM_TotalLeaf_Area),])

anova(fit6,fit7) #Yes, initial size is important. 

summary(fit6) #The larger you are, the more likely you are to die. 
#IF your competitor survives, you are more likely to as well. This is like kin selection..

```


Do analysis on fecundity and add in fern and gluc conc and flav conc to previous analyses. 



#GM Fecundity
```{r}
dat2$Comp_Survival<-as.factor(dat2$Comp_Survival)
#IS Family Important
fit<-glmmTMB(GM_Fecundity~Fern+BlackPathDam+WhiteFungLogis+competitor+Standardize(comp_Size)+Comp_Survival+Standardize(GM_TotalLeaf_Area)+(1|Family),data=dat2[!is.na(dat2$BlackPathDam),])
fit1<-glmmTMB(GM_Fecundity~Fern+BlackPathDam+WhiteFungLogis+competitor+Standardize(comp_Size)+Comp_Survival+Standardize(GM_TotalLeaf_Area),data=dat2[!is.na(dat2$BlackPathDam),])
anova(fit,fit1) #Family is important in the GM treatment for fecundity. 

#IS black path dam important?
fit<-glmmTMB(GM_Fecundity~Fern+BlackPathDam+WhiteFungLogis+competitor+Standardize(comp_Size)+Comp_Survival+Standardize(GM_TotalLeaf_Area)+(1|Family),data=dat2[!is.na(dat2$BlackPathDam),])
fit1<-glmmTMB(GM_Fecundity~Fern+WhiteFungLogis+competitor+Standardize(comp_Size)+Comp_Survival+Standardize(GM_TotalLeaf_Area)+(1|Family),data=dat2[!is.na(dat2$BlackPathDam),])
anova(fit,fit1) #No


#Is white fung dam?
fit1<-glmmTMB(GM_Fecundity~Fern+WhiteFungLogis+competitor+Standardize(GM_TotalLeaf_Area)+comp_Size+Comp_Survival+(1|Family),data=dat2[!is.na(dat2$WhiteFungLogis),])
fit2<-glmmTMB(GM_Fecundity~Fern+competitor+Standardize(GM_TotalLeaf_Area)+comp_Size+Comp_Survival+(1|Family),data=dat2[!is.na(dat2$WhiteFungLogis),])
anova(fit2,fit1) #No

#IS Fern important?
fit2<-glmmTMB(GM_Fecundity~Fern+competitor+Standardize(GM_TotalLeaf_Area)+comp_Size+Comp_Survival+(1|Family),data=dat2[!is.na(dat2$Fern),])
fit3<-glmmTMB(GM_Fecundity~competitor+Standardize(GM_TotalLeaf_Area)+comp_Size+Comp_Survival+(1|Family),data=dat2[!is.na(dat2$Fern),])

anova(fit2,fit3) #Yes Fern influenced fecundity. 

#Is Size important?
fit3<-glmmTMB(GM_Fecundity~Fern+competitor+Standardize(GM_TotalLeaf_Area)+Standardize(comp_Size)+Comp_Survival+(1|Family),data=dat2[!is.na(dat2$GM_TotalLeaf_Area),])
fit4<-glmmTMB(GM_Fecundity~Fern+competitor+Standardize(comp_Size)+Comp_Survival+(1|Family),data=dat2[!is.na(dat2$GM_TotalLeaf_Area),])
anova(fit3,fit4) #No Size is not important

#Is competitor important? 
fit4<-glmmTMB(GM_Fecundity~Fern+competitor+Standardize(comp_Size)+Comp_Survival+(1|Family),data=dat2[!is.na(dat2$competitor),])
fit5<-glmmTMB(GM_Fecundity~Fern+Standardize(comp_Size)+Comp_Survival+(1|Family),data=dat2[!is.na(dat2$competitor),])
anova(fit4,fit5) #Yes the competitor does influence fecundity.


#Is competitor size (First year) important? 
fit4<-glmmTMB(Standardize(GM_Fecundity)~Standardize(Fern)+competitor+Standardize(comp_Size)+Comp_Survival+(1|Family),data=dat2[!is.na(dat2$comp_Size),])
fit5<-glmmTMB(Standardize(GM_Fecundity)~Standardize(Fern)+competitor+Comp_Survival+(1|Family),data=dat2[!is.na(dat2$comp_Size),])
anova(fit4,fit5) #No competitor size in the first year is not significant (on the edge)
summary(fit4)

#IS comp survival important? 
fit5<-glmmTMB(Standardize(GM_Fecundity)~Standardize(Fern)+competitor+Comp_Survival+(1|Family),data=dat2[!is.na(dat2$Comp_Survival),])
fit6<-glmmTMB(Standardize(GM_Fecundity)~Standardize(Fern)+competitor+(1|Family),data=dat2[!is.na(dat2$Comp_Survival),])
anova(fit5,fit6) #Yes, competitor survival is incredibly important to determien the survival of the focal plant. 
summary(fit5)

#Is comp size importnat? 
fit5<-glmmTMB(Standardize(GM_Fecundity)~Standardize(Fern)+competitor+Comp_Survival+CompSizeBolt+(1|Family),data=dat2[!is.na(dat2$CompSizeBolt),])
fit6<-glmmTMB(Standardize(GM_Fecundity)~Standardize(Fern)+competitor+Comp_Survival+(1|Family),data=dat2[!is.na(dat2$CompSizeBolt),])
anova(fit5,fit6) #Yes, competitor size is also important. 

# Reassessing IS comp survival important? 
fit5<-glmmTMB(GM_Fecundity~competitor+Standardize(Fern)+Comp_Survival+CompSizeBolt+(1|Family),data=dat2[!is.na(dat2$Comp_Survival),])
fit6<-glmmTMB(GM_Fecundity~competitor+Standardize(Fern)+CompSizeBolt+(1|Family),data=dat2[!is.na(dat2$Comp_Survival),])
anova(fit5,fit6) #Using size removes the significance of comp survival. Unsurprising due to how zero inflated it is. I will have to pick and choose one... i chose survival. 

# Reassessing IS comp size important? 
fit5<-glmmTMB(Standardize(GM_Fecundity)~competitor+Standardize(CompSizeBolt)+(1|Family),data=dat2[!is.na(dat2$CompSizeBolt),])
fit6<-glmmTMB(Standardize(GM_Fecundity)~competitor+(1|Family),data=dat2[!is.na(dat2$CompSizeBolt),])
anova(fit5,fit6) 
summary(fit5)

summary(fit5) #
#IF your competitor survives, you are more likely to as well. This is like kin selection..

#Reassessing Fern
fit2<-glmmTMB(Standardize(GM_Fecundity)~Standardize(Fern)+competitor+Comp_Survival+(1|Family),data=dat2[!is.na(dat2$Fern),])
fit3<-glmmTMB(Standardize(GM_Fecundity)~competitor+Comp_Survival+(1|Family),data=dat2[!is.na(dat2$Fern),])
anova(fit2,fit3) 

```





