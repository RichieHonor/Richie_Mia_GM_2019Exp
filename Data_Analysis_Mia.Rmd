---
title: "A. petiolata Analysis"
author: "Mia Marcellus"
date: "1/11/2020"
output: html_document
---
Load the data

```{r}
#This clears the working environment for you.
rm(list=ls())
gmdata <- read.csv("DataSynthesis.csv",stringsAsFactors = F)
```

Load libraries
```{r}
library(ggplot2)
library(dplyr)
```

```{r}

#c|BWPEM1-9-0|Q|10
#make new vectors
plate <- gsub("\\|.*", "", gmdata$Tag)
plate
```

Distinguish the family from the "Tag" column using strsplit
```{r}
for(i in 1:length(gmdata$Tag)){
  strsplit(gmdata$Tag[i],"|", fixed = TRUE) [[1]]
    fam <- strsplit(gmdata$Tag[i],"|", fixed = TRUE) [[1]][2] #splits into family
    fam<-strsplit(fam,"-", fixed = TRUE) [[1]][1]
  gmdata$Family[i] <- fam
  
}
#make more efficient using apply function (or see above code chunk for more efficient way)
```

Summary Stats
```{r}
summary(gmdata)
```

Frequency distribution for glucosinolate content
```{r}
ggplot(gmdata)+
geom_histogram(aes(x = gluc_Conc), binwidth = 0.007)+
  theme_bw()+
  labs(x = "Glucosinolate concentration", y = "Frequency")
```

Frequency distribution for flavonoid content
```{r}
ggplot(gmdata)+
geom_histogram(aes(x = flav_Conc), binwidth = 0.003)+
  theme_bw()+
  labs(x = "Flavonoid concentration", y = "Frequency")
```

Frequency distribution for chlorophyll a content
```{r}
ggplot(gmdata)+
geom_histogram(aes(x = ChlorA), bins = 40)+
  theme_bw()+
  labs(x = "Chlorophyll a", y = "Frequency")
```

Frequency distribution for chlorophyll b content
```{r}
ggplot(gmdata)+
geom_histogram(aes(x = ChlorB), bins = 40)+
  theme_bw()+
  labs(x = "Chlorophyll b", y = "Frequency")
```

Frequency distribution for leaf length
```{r}
ggplot(gmdata)+
geom_histogram(aes(x = leaf_length), bins = 25)+
  theme_bw()+
  labs(x = "Leaf length (cm)", y = "Frequency")
```


Graph glucosinolate conc according to treatment and family
```{r}
ggplot(data = gmdata, aes(x = treatment, y =  gluc_Conc, colour = Family))+
  geom_point(size = 4, alpha = 0.4)+
  geom_line(aes(group = Family))+
  labs(x = "Treatment", y = "Glucosinolate Concentration", colour = "Family")


```
Figure 1. A. petiolata glucosinolate concentration according to treatment (a = alone, gm = intraspecific, m = interspecific, NA = pools) and family. Data not normalized by chlorophyll content. 

Graph flavonoid conc according to treatment and family
```{r}
ggplot(data = gmdata, aes(x = treatment, y =  flav_Conc, colour = Family))+
  geom_point(size = 4, alpha = 0.7)+
  geom_line(aes(group = Family))+
  labs(x = "Treatment", y = "Flavonoid Concentration", fill = "Family")
```
Figure 2. A. petiolata flavonoid concentration according to treatment (a = alone, gm = intraspecific, m = interspecific, NA = pools) and family. Data not normalized by chlorophyll content.

Graph chlorophyll A content according to treatment and family
```{r}
ggplot(data = gmdata, aes(x = treatment, y = ChlorA, colour = Family))+
  geom_point(size = 4, alpha = 0.7)+
  geom_line(aes(group = Family))+
  labs(x = "Treatment", y = "Chlorophyll a", fill = "Family")
```

Graph chlorophyll b content according to treatment and family
```{r}
ggplot(data = gmdata, aes(x = treatment, y =  ChlorB, colour = Family))+
  geom_point(size = 4, alpha = 0.7)+
  geom_line(aes(group = Family))+
  labs(x = "Treatment", y = "Chlorophyll b", fill = "Family")
```

Graph chlorophyll a and b content against glucosinolate concentration for plants grown alone
```{r}
#separate plants into alone treatment
ALN <- gmdata[grepl("a",gmdata$treatment),]

#chlorophyll a
plot(ALN$ChlorA ~ ALN$gluc_Conc, data = ALN, xlab = "Glucosinolate Concentration", ylab = "Chlorophyll a Content")
abline(lm(ALN$ChlorA ~ ALN$gluc_Conc, data = ALN))

#chlorophyll b
plot(ALN$ChlorB ~ ALN$gluc_Conc, data = ALN, xlab = "Glucosinolate Concentration", ylab = "Chlorophyll b Content")
abline(lm(ALN$ChlorB ~ ALN$gluc_Conc, data = ALN))
```

Graph chlorophyll a and b content against flavonoid concentration for plants grown alone
```{r}
#chlorophyll a
plot(ALN$ChlorA ~ ALN$flav_Conc, data = ALN, xlab = "Flavonoid Concentration", ylab = "Chlorophyll a Content")
abline(lm(ALN$ChlorA ~ ALN$flav_Conc, data = ALN))

#chlorophyll b
plot(ALN$ChlorB ~ ALN$flav_Conc, data = ALN, xlab = "Flavonoid Concentration", ylab = "Chlorophyll b Content")
abline(lm(ALN$ChlorB ~ ALN$flav_Conc, data = ALN))
```

Graph chlorophyll a and b content against glucosinolate concentration for plants grown with maples
```{r}
#separate plants into maple treatment
MPL <- gmdata[grepl("m",gmdata$treatment),]
#chlorophyll a
plot(MPL$ChlorA ~ MPL$gluc_Conc, data = MPL, xlab = "Glucosinolate Concentration", ylab = "Chlorophyll a Content")
abline(lm(MPL$ChlorA ~ MPL$gluc_Conc, data = MPL))

#chlorophyll b
plot(MPL$ChlorB ~ MPL$gluc_Conc, data = MPL, xlab = "Glucosinolate Concentration", ylab = "Chlorophyll b Content")
abline(lm(MPL$ChlorB ~ MPL$gluc_Conc, data = MPL))
```
Graph chlorophyll a and b content against glucosinolate concentration for plants grown with other gm
```{r}
#separate plants into maple treatment
GM <- gmdata[grepl("gm",gmdata$treatment),]
#chlorophyll a
plot(GM$ChlorA ~ GM$gluc_Conc, data = GM, xlab = "Glucosinolate Concentration", ylab = "Chlorophyll a Content")
abline(lm(GM$ChlorA ~ GM$gluc_Conc, data = GM))

#chlorophyll b
plot(GM$ChlorB ~ GM$gluc_Conc, data = GM, xlab = "Glucosinolate Concentration", ylab = "Chlorophyll b Content")
abline(lm(GM$ChlorB ~ GM$gluc_Conc, data = GM))
```

Graph chlorophyll content for interspecific plants against chlorophyll for intraspecific plants
```{r}
plot(gmdata$ChlorA[gmdata$treatment=="m"] ~ gmdata$ChlorA[gmdata$treatment=="gm"])
  #error: variable lengths must be the same                                                  
```



